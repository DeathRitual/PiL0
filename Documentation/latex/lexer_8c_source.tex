\hypertarget{lexer_8c_source}{\subsection{/home/nirvash/\-Projects/\-Pi\-L0/lexer.c}
}

\begin{DoxyCode}
00001 
00019 \textcolor{preprocessor}{#include "\hyperlink{lexer_8h}{lexer.h}"}
00020 \textcolor{preprocessor}{#include "\hyperlink{language_8h}{language.h}"}
00021 \textcolor{preprocessor}{#include<stddef.h>}
00022 \textcolor{preprocessor}{#include<stdio.h>}
00023 \textcolor{preprocessor}{#include<stdlib.h>}
00024 \textcolor{preprocessor}{#include<string.h>}
00025 \textcolor{preprocessor}{#include<ctype.h>}
00026 \textcolor{preprocessor}{#ifndef tokdef\_C}
00027 \textcolor{preprocessor}{}
00028 \textcolor{comment}{/*}
00029 \textcolor{comment}{ * }
00030 \textcolor{comment}{ * Error Handling}
00031 \textcolor{comment}{ * }
00032 \textcolor{comment}{*/}
00033 
\hypertarget{lexer_8c_source_l00038}{}\hyperlink{lexer_8c_ac904322e9cd774d033d702016491a991}{00038} \textcolor{keyword}{static} \textcolor{keywordtype}{char} *\hyperlink{lexer_8c_ac904322e9cd774d033d702016491a991}{err_msg}[] = \{
00039     \textcolor{stringliteral}{"Null-Pointer"}, \textcolor{stringliteral}{"Kein Speicher frei"},
00040     \textcolor{stringliteral}{"Liste ist leer"}
00041   \}; 
00042   
\hypertarget{lexer_8c_source_l00046}{}\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55}{00046} \textcolor{keyword}{enum} \hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55}{err_codes} \{
\hypertarget{lexer_8c_source_l00047}{}\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{00047}     \hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{NULL_POINTER}, \hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55afb88c5fa6e7d51074ec36bd4578e03a0}{ERR_MEMORY}, \hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a60202b752d64be3e9634f160ce5dca7d}{EMPTY_LIST}
00048   \};
00049   
00050 
\hypertarget{lexer_8c_source_l00056}{}\hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{00056} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\textcolor{keyword}{enum} \hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55}{err_codes} msg\_nr) \{
00057   fprintf(stderr, \textcolor{stringliteral}{"FEHLER(intlist): %s!\(\backslash\)n"}, \hyperlink{lexer_8c_ac904322e9cd774d033d702016491a991}{err_msg}[msg\_nr]);
00058   exit(10);
00059 \}
00060 
00061 
00062 \textcolor{comment}{/*}
00063 \textcolor{comment}{ * }
00064 \textcolor{comment}{ * FIFO Implementation}
00065 \textcolor{comment}{ * }
00066 \textcolor{comment}{ */}
00067 
\hypertarget{lexer_8c_source_l00072}{}\hyperlink{lexer_8c_ac89b2e52a88dfd9ed05bbacf90176fcd}{00072} \textcolor{keyword}{struct }\hyperlink{lexer_8h_struct__tag__list}{_tag_list} *\hyperlink{lexer_8c_ac89b2e52a88dfd9ed05bbacf90176fcd}{head};
00073 
\hypertarget{lexer_8c_source_l00080}{}\hyperlink{lexer_8h_ac9f8b5800165d01c9c53895ab3027f5d}{00080} \textcolor{keywordtype}{void} \hyperlink{lexer_8c_aeaf25962d905093a69389e62796e237b}{l_init}(list *l) \{
00081   \textcolor{keywordflow}{if} (l == NULL) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{NULL_POINTER});
00082   *l = NULL; 
00083 \}
00084 
\hypertarget{lexer_8c_source_l00091}{}\hyperlink{lexer_8h_ad38fb956f3e8b88088d0c3dbd9b0b1cd}{00091} \textcolor{keywordtype}{int} \hyperlink{lexer_8c_a6b9833eb6c0963b6d2e4b76d7e460caa}{l_IsEmpty}(list l) \{
00092   \textcolor{keywordflow}{return} l == NULL;
00093 \} 
00094 
\hypertarget{lexer_8c_source_l00103}{}\hyperlink{lexer_8h_a81ffeff3bff153b2a5e8576bad3c1145}{00103} \textcolor{keywordtype}{void} \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(list *l, \textcolor{keywordtype}{char} *t, \textcolor{keywordtype}{int} *n) \{
00104   \textcolor{keywordflow}{if} (l == NULL) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{NULL_POINTER});
00105   \textcolor{keyword}{struct }\hyperlink{lexer_8h_struct__tag__list}{_tag_list} *el; 
00106   \textcolor{keywordflow}{if} ((el = malloc(\textcolor{keyword}{sizeof}(list))) == NULL) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55afb88c5fa6e7d51074ec36bd4578e03a0}{ERR_MEMORY});
00107   \textcolor{keywordflow}{if} (isdigit(*t) > 0) \{
00108     el->number.n = atoi(t);
00109     el->number.ID = *n;
00110     el->\hyperlink{lexer_8h_a1b949e00a2c76f6830b80942c1d65341}{type} = \textcolor{charliteral}{'n'};
00111   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (isalpha(*t) > 0) \{
00112     strcpy(el->word.w, t);
00113     el->word.ID = *n;
00114     el->\hyperlink{lexer_8h_a1b949e00a2c76f6830b80942c1d65341}{type} = \textcolor{charliteral}{'w'};
00115   \} \textcolor{keywordflow}{else} \{
00116     el->token.t = *t;
00117     el->\hyperlink{lexer_8h_a1b949e00a2c76f6830b80942c1d65341}{type} = \textcolor{charliteral}{'t'};
00118   \}
00119   el->\hyperlink{lexer_8h_a3778a8980f4cc9236d8288e5e364b9d3}{next} = *l;
00120   el->\hyperlink{lexer_8h_aff2d3980f345bfd4ed08d44550f481bf}{previous} = NULL;
00121   \textcolor{keywordflow}{if} (!\hyperlink{lexer_8c_a6b9833eb6c0963b6d2e4b76d7e460caa}{l_IsEmpty}(*l)) (*l)->\hyperlink{lexer_8h_aff2d3980f345bfd4ed08d44550f481bf}{previous} = el;
00122   \textcolor{keywordflow}{if} (\hyperlink{lexer_8c_a6b9833eb6c0963b6d2e4b76d7e460caa}{l_IsEmpty}(*l)) head = el;
00123   *l = el;
00124 \}
00125 
\hypertarget{lexer_8c_source_l00132}{}\hyperlink{lexer_8h_a9a72d95129580ef11dc9778edb80004f}{00132} \textcolor{keywordtype}{void} \hyperlink{lexer_8c_a597a6fc15d83dfb2d062ac6ca1039c06}{l_remove}(list *l) \{
00133   \textcolor{keywordflow}{if} (l == NULL) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{NULL_POINTER});
00134   \textcolor{keywordflow}{if} (\hyperlink{lexer_8c_a6b9833eb6c0963b6d2e4b76d7e460caa}{l_IsEmpty}(*l)) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a60202b752d64be3e9634f160ce5dca7d}{EMPTY_LIST});
00135   \textcolor{keywordflow}{if} (head == *l) \{
00136     free(head);
00137     *l = NULL;
00138   \} \textcolor{keywordflow}{else} \{
00139   \textcolor{keyword}{struct }\hyperlink{lexer_8h_struct__tag__list}{_tag_list} *ptr; 
00140   ptr = head->\hyperlink{lexer_8h_aff2d3980f345bfd4ed08d44550f481bf}{previous};
00141   ptr->\hyperlink{lexer_8h_a3778a8980f4cc9236d8288e5e364b9d3}{next} = NULL;
00142   head->\hyperlink{lexer_8h_aff2d3980f345bfd4ed08d44550f481bf}{previous} = NULL;
00143   free(head);
00144   head = ptr;
00145   \}
00146 \}
00147 
\hypertarget{lexer_8c_source_l00154}{}\hyperlink{lexer_8h_aa04f7ac992f12dbdcc80fdf4c624f7e9}{00154} list \hyperlink{lexer_8c_a662de1b392ef548996d646fdac76fdf4}{l_top}(list l) \{
00155   \textcolor{keywordflow}{if} (\hyperlink{lexer_8c_a6b9833eb6c0963b6d2e4b76d7e460caa}{l_IsEmpty}(l)) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{NULL_POINTER});
00156   \textcolor{keywordflow}{return} \hyperlink{lexer_8c_ac89b2e52a88dfd9ed05bbacf90176fcd}{head};
00157 \}
00158 
\hypertarget{lexer_8c_source_l00165}{}\hyperlink{lexer_8h_a5a84ca70ef422afe2fbb8d4472f55e15}{00165} list \hyperlink{lexer_8c_a3e647acbc5d046872adef10908ea44b4}{l_last}(list l) \{
00166   \textcolor{keywordflow}{if} (\hyperlink{lexer_8c_a6b9833eb6c0963b6d2e4b76d7e460caa}{l_IsEmpty}(l)) \hyperlink{lexer_8c_a8b4b6428a8bf1450cf23b6032dec56cf}{error}(\hyperlink{lexer_8c_ad7109e2dccd18353c3bdd5f55ad94b55a4fb873dc451927ef6a70af3a1e7f08bd}{NULL_POINTER});
00167   \textcolor{keywordflow}{return} l;
00168 \}
00169 
00170 \textcolor{comment}{/*}
00171 \textcolor{comment}{ * }
00172 \textcolor{comment}{ * keyword definition}
00173 \textcolor{comment}{ * }
00174 \textcolor{comment}{ */}
00175 
00176 
\hypertarget{lexer_8c_source_l00186}{}\hyperlink{lexer_8h_a3c9e5c09d162b2bfeaddb5e9390ce41b}{00186} \textcolor{keywordtype}{int} \hyperlink{lexer_8c_a9670ac79a4525a9152a28835404e2470}{get_keyNUM}(\hyperlink{lexer_8h_structkeyword}{keyword} *k, \textcolor{keywordtype}{char} *s) \{
00187   \textcolor{keywordtype}{int} i = 0;
00188   \textcolor{keywordflow}{for} (i = 0; \hyperlink{language_8h_a378b0ae598a7cfd7eb28be463d4cc909}{keywords}[i] != NULL; i++) 
00189     \textcolor{keywordflow}{if} (strcmp(k[i].w, s) == 0) \textcolor{keywordflow}{return} i;
00190   \textcolor{keywordflow}{return} -1;
00191 \}
00192 
\hypertarget{lexer_8c_source_l00198}{}\hyperlink{lexer_8c_a6b0f05b95e21ab606b1aa2b573d0ed31}{00198} \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \hyperlink{lexer_8c_a6b0f05b95e21ab606b1aa2b573d0ed31}{get_keySize}() \{
00199   \textcolor{keywordtype}{int} i = 1;
00200   \textcolor{keywordflow}{while} (\hyperlink{language_8h_a378b0ae598a7cfd7eb28be463d4cc909}{keywords}[i] != NULL)
00201     i++;
00202   \textcolor{keywordflow}{return} i;
00203 \}
00204 
\hypertarget{lexer_8c_source_l00210}{}\hyperlink{lexer_8h_a2dad3191a25934603cb3427980b3505b}{00210} \hyperlink{lexer_8h_structkeyword}{keyword} *\hyperlink{lexer_8c_a7f47851ed6277df979bcf14757dac244}{init_ReservedKeys}() \{
00211   \hyperlink{lexer_8h_structkeyword}{keyword} *resKeys = malloc(\textcolor{keyword}{sizeof} *resKeys * \hyperlink{lexer_8c_a6b0f05b95e21ab606b1aa2b573d0ed31}{get_keySize}());
00212   \textcolor{keywordtype}{int} i;
00213   \textcolor{keywordflow}{for} (i = 0; \hyperlink{language_8h_a378b0ae598a7cfd7eb28be463d4cc909}{keywords}[i] != NULL; i++) \{
00214     strcpy(resKeys[i].w,\hyperlink{language_8h_a378b0ae598a7cfd7eb28be463d4cc909}{keywords}[i]);
00215     resKeys[i].\hyperlink{lexer_8h_a79da3556d7a0b19c9d1ce39e9d4a0bc7}{ID} = 256 + i;
00216   \}
00217   \textcolor{keywordflow}{return} resKeys;
00218 \}
00219 
00220 
\hypertarget{lexer_8c_source_l00229}{}\hyperlink{lexer_8h_a7888e6f1b0face769b162422686b9e46}{00229} list \hyperlink{lexer_8c_ae6bbe9beac82b1e87f2dd4c3cdc1c9ba}{lexer}(\textcolor{keywordtype}{char} *raw\_code) \{
00230   \hyperlink{lexer_8h_structkeyword}{keyword} *reserved = \hyperlink{lexer_8c_a7f47851ed6277df979bcf14757dac244}{init_ReservedKeys}();
00231   list token\_stream, tok;
00232   \hyperlink{lexer_8c_aeaf25962d905093a69389e62796e237b}{l_init}(&token\_stream);
00233 
00234   printf(\textcolor{stringliteral}{"\(\backslash\)n%s\(\backslash\)n\(\backslash\)n"}, raw\_code);
00235   \textcolor{keywordtype}{int} i;
00236   \textcolor{keywordflow}{for} (i = 0; i < strlen(raw\_code); i++) \{
00237     \textcolor{keywordtype}{char} w[20] = \textcolor{stringliteral}{""};
00238     \textcolor{keywordtype}{int} j = 0, key\_NUM, ident = \hyperlink{lexer_8h_a3033e03f16b6d2620a2e39b45718f5b4a84f8ae2490f9e4bd2321fd21f4b0e807}{IDENTIFIER};
00239     
00240     \textcolor{keywordflow}{while} (raw\_code[i] < 33)
00241       i++;
00242 
00243     \textcolor{keywordflow}{if} (raw\_code[i] == 61 && raw\_code[i + 1] == 61) \{
00244       key\_NUM = \hyperlink{lexer_8c_a9670ac79a4525a9152a28835404e2470}{get_keyNUM}(reserved, \textcolor{stringliteral}{"=="});
00245       \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, reserved[key\_NUM].w, &reserved[key\_NUM].ID);
00246       i++;
00247     \}
00248     \textcolor{keywordflow}{if} (raw\_code[i] == 60 && raw\_code[i + 1] == 61) \{
00249       key\_NUM = \hyperlink{lexer_8c_a9670ac79a4525a9152a28835404e2470}{get_keyNUM}(reserved, \textcolor{stringliteral}{"<="});
00250       \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, reserved[key\_NUM].w, &reserved[key\_NUM].ID);
00251       i++;
00252     \}
00253     \textcolor{keywordflow}{if} (raw\_code[i] == 62 && raw\_code[i + 1] == 61) \{
00254       key\_NUM = \hyperlink{lexer_8c_a9670ac79a4525a9152a28835404e2470}{get_keyNUM}(reserved, \textcolor{stringliteral}{">="});
00255       \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, reserved[key\_NUM].w, &reserved[key\_NUM].ID);
00256       i++;
00257     \}
00258     \textcolor{keywordflow}{if} (raw\_code[i] == 33 && raw\_code[i + 1] == 61) \{
00259       key\_NUM = \hyperlink{lexer_8c_a9670ac79a4525a9152a28835404e2470}{get_keyNUM}(reserved, \textcolor{stringliteral}{"!="});
00260       \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, reserved[key\_NUM].w, &reserved[key\_NUM].ID);
00261       i++;
00262     \}
00263 
00264     
00265     \textcolor{keywordflow}{if} (isalpha(raw\_code[i])) \{
00266       \textcolor{keywordflow}{do} \{
00267         w[j] = raw\_code[i];
00268         j++;
00269         i++;
00270       \} \textcolor{keywordflow}{while} (isalnum(raw\_code[i]));
00271       key\_NUM = \hyperlink{lexer_8c_a9670ac79a4525a9152a28835404e2470}{get_keyNUM}(reserved, w);
00272       \textcolor{keywordflow}{if} (key\_NUM >= 0) \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, reserved[key\_NUM].w, &reserved[
      key\_NUM].ID);
00273       \textcolor{keywordflow}{else} \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, w, &ident);
00274     \}
00275    
00276     ident = \hyperlink{lexer_8h_a3033e03f16b6d2620a2e39b45718f5b4a17897512ed7598aeb5912e3d45bf000d}{NUM};
00277     \textcolor{keywordflow}{if} (isdigit(raw\_code[i])) \{
00278       \textcolor{keywordflow}{do} \{
00279         w[j] = raw\_code[i];
00280         j++;
00281         i++;
00282       \} \textcolor{keywordflow}{while} (isdigit(raw\_code[i]));
00283       \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, w, &ident);
00284     \}
00285 
00286     \textcolor{keywordflow}{if} (strlen(w) > 0) i--;
00287     \textcolor{keywordflow}{else} \hyperlink{lexer_8c_a46cdfdb54ba6b79debb3745f650bcdbe}{l_append}(&token\_stream, &raw\_code[i], &ident);
00288     
00289     tok = \hyperlink{lexer_8c_a3e647acbc5d046872adef10908ea44b4}{l_last}(token\_stream);
00290     \textcolor{keywordflow}{switch}(tok->type) \{
00291       \textcolor{keywordflow}{case} \textcolor{charliteral}{'t'}: printf(\textcolor{stringliteral}{"Token: %c\(\backslash\)n"}, tok->token.t);
00292                 \textcolor{keywordflow}{break};
00293       \textcolor{keywordflow}{case} \textcolor{charliteral}{'w'}: printf(\textcolor{stringliteral}{"Word: %s, %d\(\backslash\)n"}, tok->word.w, tok->word.ID);
00294                 \textcolor{keywordflow}{break};
00295       \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}: printf(\textcolor{stringliteral}{"Number: %d, %d\(\backslash\)n"}, tok->number.n, tok->number.ID);
00296                 \textcolor{keywordflow}{break};
00297     \}
00298   \}
00299   \textcolor{keywordflow}{return} token\_stream;
00300 \} 
00301 
00302 
00303 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
